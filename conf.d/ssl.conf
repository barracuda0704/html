<IfModule mod_ssl.c>

<VirtualHost *:8443>
        ServerAdmin webmaster@localhost
        ServerName robotics.int-rt.corp.doosan.com
 
        SSLEngine On

        #ReverseProxy를 사용하기 위함.
        ProxyRequests Off

        DocumentRoot /opt/app-root/src
 
        # ErrorLog /var/log/apache2/rewrite.log
 
        # #에러로그는 자율형식
        # CustomLog /var/log/apache2/test_ssl_access.log "%h %l %u %t %n \"%r\" %>s %b \"%{Referer}i\" %n \"%{User-Agent}i %n \ SSLprotocol: %{SSL_PROTOCOL}x %n \SSLclient name: %{SSL_CLIENT_S_DN_CN}x %n \SSLclientEmail: %{SSL_CLIENT_S_DN_EMAIL}x %n
 
        SSLCertificateFile /opt/app-root/src/conf.d/certs/robotics.int-rt.corp.doosan.com.cert.pem
        SSLCertificateKeyFile /opt/app-root/src/conf.d/certs/robotics.int-rt.corp.doosan.com.key.pem
 
        #루트CA의 인증서 경로
        SSLCACertificatePath /opt/app-root/src/conf.d/certs/
        SSLCACertificateFile /opt/app-root/src/conf.d/certs/root-ca.cert.pem
  
        #CRL경로 
        SSLCARevocationPath /opt/app-root/src/conf.d/certs/
        SSLCARevocationFile /opt/app-root/src/conf.d/certs/intermed-ca.crl
  
        #사용자 인증서 점검
        SSLVerifyClient require
        SSLVerifyDepth 2
  
        #인증서 폐기 목록 검증하는 부분
        SSLCARevocationCheck leaf
 
        #인증서 검증에 실패하였을 경우, 프록시 접근 Deny
        <Proxy *>
            Order deny,allow
            Allow from all
          
        </Proxy>
 
        SSLOptions +StdEnvVars
        <FilesMatch "\.(cgi|shtml|phtml|php)$">
                SSLOptions +StdEnvVars
        </FilesMatch>
        <Directory /usr/lib/cgi-bin>
                SSLOptions +StdEnvVars
        </Directory>
         BrowserMatch "MSIE [2-6]" \
                nokeepalive ssl-unclean-shutdown \
                downgrade-1.0 force-response-1.0
        </VirtualHost>
 
</IfModule>
  
